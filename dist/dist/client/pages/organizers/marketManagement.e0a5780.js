(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{1056:function(t,e,n){"use strict";var r={data:function(){return{pagination:{current:1,pageSize:10,total:0,showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:["5","10","15","20","30","40"],showTotal:function(t){return" 共".concat(t,"条")}}}},methods:{resetPage:function(){this.pagination.current=1,this.pagination.total=0},handleTableChange:function(t){this.pagination=t,this.getListHand&&this.getListHand()},handlePaginatChange:function(t,e){this.pagination.current=t,this.pagination.pageSize=e,this.getListHand&&this.getListHand(),this.$backScrollTop()},setTotalHandle:function(data,t,e){this.pagination.total=+data.data.total,this.pagination.total&&!data.data[t].length?(this.pagination.current=this.pagination.current-1,this.getListHand&&this.getListHand()):e()}}},o=n(18),component=Object(o.a)(r,(function(){var t=this.$createElement;return(this._self._c||t)("div")}),[],!1,null,null,null);e.a=component.exports},1063:function(t,e,n){"use strict";function r(source,t){if(null==source)return{};var e,i,n=function(source,t){if(null==source)return{};var e,i,n={},r=Object.keys(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||(n[e]=source[e]);return n}(source,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(source);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(source,e)&&(n[e]=source[e])}return n}n.d(e,"a",(function(){return r}))},1070:function(t,e,n){"use strict";n.d(e,"H",(function(){return d})),n.d(e,"v",(function(){return m})),n.d(e,"k",(function(){return f})),n.d(e,"n",(function(){return h})),n.d(e,"u",(function(){return v})),n.d(e,"C",(function(){return _})),n.d(e,"i",(function(){return y})),n.d(e,"t",(function(){return C})),n.d(e,"r",(function(){return z})),n.d(e,"q",(function(){return k})),n.d(e,"s",(function(){return $})),n.d(e,"G",(function(){return x})),n.d(e,"F",(function(){return w})),n.d(e,"B",(function(){return O})),n.d(e,"I",(function(){return I})),n.d(e,"l",(function(){return S})),n.d(e,"N",(function(){return M})),n.d(e,"d",(function(){return j})),n.d(e,"L",(function(){return H})),n.d(e,"M",(function(){return L})),n.d(e,"f",(function(){return D})),n.d(e,"w",(function(){return T})),n.d(e,"h",(function(){return A})),n.d(e,"e",(function(){return P})),n.d(e,"g",(function(){return R})),n.d(e,"J",(function(){return N})),n.d(e,"K",(function(){return F})),n.d(e,"A",(function(){return E})),n.d(e,"x",(function(){return Y})),n.d(e,"z",(function(){return K})),n.d(e,"y",(function(){return V})),n.d(e,"a",(function(){return U})),n.d(e,"c",(function(){return B})),n.d(e,"j",(function(){return Q})),n.d(e,"b",(function(){return J})),n.d(e,"m",(function(){return W})),n.d(e,"p",(function(){return G})),n.d(e,"D",(function(){return X})),n.d(e,"E",(function(){return Z})),n.d(e,"o",(function(){return tt}));var r=n(1063),o=n(19),c=n(30),l=n.n(c),d=function(t){return o.a.post("/school/lecturer/course/previewTime/".concat(t.courseId,"/").concat(t.liveId),l.a.stringify(t.info))},m=function(t){return o.a.post("/school/lecturer/play/live/".concat(t.courseId,"/").concat(t.liveId))},f=function(t){return o.a.post("/school/lecturer/course/create",l.a.stringify(t))},h=function(t){return o.a.post("/school/lecturer/course/save/".concat(t.id),l.a.stringify(t))},v=function(t){return o.a.post("/school/lecturer/course/list",l.a.stringify(t))},_=function(t){return o.a.post("/school/lecturer/course/delete/".concat(t))},y=function(t){return o.a.post("/school/lecturer/course/status/".concat(t.courseId,"/").concat(t.onStore))},C=function(t){return o.a.post("/school/lecturer/course/info/".concat(t))},z=function(t){return o.a.post("/school/lecturer/series/list",l.a.stringify(t))},k=function(t){return o.a.post("/school/lecturer/series/child/list/".concat(t.courseId),l.a.stringify(t.info))},$=function(t){return o.a.post("/school/lecturer/series/chapter/list/".concat(t))},x=function(t){return o.a.post("/school/lecturer/series/chapter/save/".concat(t.courseId),t.info,{headers:{"Content-Type":"application/json;charset=utf-8"}})},w=function(t){return o.a.post("/school/lecturer/series/child/save/".concat(t.courseId),l.a.stringify(t.info))},O=function(t){return o.a.post("/school/lecturer/series/child/delete/".concat(t.courseId,"/").concat(t.liveId))},I=function(t){return o.a.post("/school/lecturer/series/child/status/".concat(t.courseId,"/").concat(t.liveId,"/").concat(t.onStore))},S=function(){return o.a.post("/school/lecturer/home/index")},M=function(t){return o.a.post("/school/lecturer/home/trend",l.a.stringify(t))},j=function(t){return o.a.post("/school/lecturer/home/conversion",l.a.stringify(t))},H=function(t){return o.a.post("/school/lecturer/student/list",l.a.stringify(t))},L=function(t){var e=t.suserId,n=Object(r.a)(t,["suserId"]);return o.a.post("/school/lecturer/student/push/".concat(e),l.a.stringify(n))},D=function(t){return o.a.post("/school/lecturer/coupon/list",l.a.stringify(t))},T=function(t){return o.a.post("/school/lecturer/data/course/simple",l.a.stringify(t))},A=function(t){var e=t.courseId,n=Object(r.a)(t,["courseId"]);return o.a.post("/school/lecturer/coupon/save/".concat(e),l.a.stringify(n))},P=function(t){var e=t.courseId,n=t.couponId;return o.a.post("/school/lecturer/coupon/".concat(e,"/delete/").concat(n))},R=function(t){var e=t.couponId,n=Object(r.a)(t,["couponId"]);return o.a.post("/school/lecturer/coupon/effect/".concat(e),l.a.stringify(n))},N=function(){return o.a.post("/school/lecturer/promotion/statData")},F=function(t){return o.a.post("/school/lecturer/promotion/statList",l.a.stringify(t))},E=function(t){var e=t.courseId,n=Object(r.a)(t,["courseId"]);return o.a.post("/school/lecturer/promotion/".concat(e,"/order/list"),l.a.stringify(n))},Y=function(t){return o.a.post("/school/lecturer/promotion/courses",l.a.stringify(t))},K=function(t){return o.a.post("/school/lecturer/promotion/".concat(t,"/config/info"))},V=function(t){var e=t.courseId,n=Object(r.a)(t,["courseId"]);return o.a.post("/school/lecturer/promotion/".concat(e,"/config/save"),l.a.stringify(n))},U=function(t){return o.a.post("/school/lecturer/camp/list",l.a.stringify(t))},B=function(t){return o.a.post("/school/lecturer/camp/save",l.a.stringify(t))},Q=function(t){return o.a.post("/school/lecturer/course/copy/".concat(t))},J=function(t){var e=t.courseId,n=t.display;return o.a.post("/school/lecturer/camp/camp/".concat(e,"/").concat(n))},W=function(t){return o.a.post("/school/lecturer/series/live/documentUpload",t)},G=function(t){return o.a.post("/school/lecturer/activity/call/list",l.a.stringify(t))},X=function(t){return o.a.post("/school/lecturer/activity/call/save",l.a.stringify(t))},Z=function(t){var e=t.id,n=t.onStore;return o.a.post("/school/lecturer/activity/call/status/".concat(e,"/").concat(n))},tt=function(t){var e=t.activityId,n=Object(r.a)(t,["activityId"]);return o.a.post("/school/lecturer/activity/record/list/".concat(e),l.a.stringify(n))}},1129:function(t,e,n){},1274:function(t,e,n){"use strict";var r=n(1129);n.n(r).a},1280:function(t,e,n){"use strict";n(88),n(50),n(44),n(32),n(64);var r=n(41);function o(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var c={props:{data:{type:Array,default:function(){return[]}},activeKey:{type:String,default:""}},data:function(){return{type:""}},created:function(){!this.activeKey&&this.init()},methods:{init:function(){this.type=this.data.length&&this.data[0].key},handleChange:function(t){this.activeKey||(this.type=t.item.key),this.$emit("change",function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?o(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):o(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},t))},_renderTitle:function(){var t=this,e=this.$createElement;return e("div",{class:"tabs"},[this.data.map((function(n,r){return e("div",{class:["tabItem",t.activeKey===n.key||t.type===n.key?"activeBg":null],on:{click:function(){t.handleChange({item:n,index:r})}}},[e("span",{class:[t.activeKey===n.key||t.type===n.key?"active":null]},n.title)])}))])},_renderSlot:function(){var t=this;return(0,this.$createElement)("div",{},[this.data.map((function(slot){if(t.activeKey===slot.key||t.type===slot.key)return t.$slots[slot.key]}))])},_renderTpl:function(){return(0,this.$createElement)("div",[this._renderTitle(),this._renderSlot()])}},render:function(){return this._renderTpl()}},l=(n(1274),n(18)),component=Object(l.a)(c,void 0,void 0,!1,null,"96cbc47e",null);e.a=component.exports},1478:function(t,e,n){t.exports=n.p+"img/toolQrCode.a0b6a17.png"},1479:function(t,e,n){},1480:function(t,e,n){t.exports=n.p+"img/ask.1c7a762.png"},1481:function(t,e,n){t.exports=n.p+"img/upload.ae530bb.png"},1482:function(t,e,n){},1483:function(t,e,n){},1484:function(t,e,n){},2076:function(t,e,n){"use strict";var r=n(1479);n.n(r).a},2077:function(t,e,n){"use strict";var r=n(1482);n.n(r).a},2078:function(t,e,n){"use strict";var r=n(1483);n.n(r).a},2079:function(t,e,n){"use strict";var r=n(1484);n.n(r).a},2180:function(t,e,n){"use strict";n.r(e);n(88),n(50),n(64);var r=n(41),o=(n(92),n(93),n(91),n(106),n(1063)),c=(n(44),n(32),n(43),n(17)),l=(n(140),n(1117)),d=n(20),m=n(21),f=n.n(m),h=n(1070),v=n(1056);function _(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function y(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?_(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):_(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var C={layout:"organizers",components:{QrcodeVue:l.a},mixins:[v.a],data:function(){return{data:[],remark:"",form:this.$form.createForm(this,{}),feecond:2,feeVal:0,restriction:"0",couponStatus:!1,title:1,id:0,distributeStatus:!1,identify:"",type:1,moment:f.a,loading:!1,effective:"0"}},computed:{couponData:function(){return[{text:this.$t("organizers/marketManage_18",{zh:"优惠券名称"}),required:!0,type:"INPUT",name:"remark",formType:"input",message:this.$t("organizers/marketManage_48",{zh:"优惠券名称不能为空"})},{text:this.$t("organizers/marketManage_25",{zh:"优惠劵金额"}),required:!0,type:"INPUT",name:"money",formType:"number",message:this.$t("organizers/marketManage_26",{zh:"优惠卷不能为空"})},{text:this.$t("organizers/marketManage_27",{zh:"数量"}),required:!0,type:"INPUT",name:"total",formType:"number",message:this.$t("organizers/marketManage_28",{zh:"数量不能为空"})},{text:this.$t("organizers/marketManage_29",{zh:"使用课程"}),required:!0,type:"SELECT",name:"courseId",option:[],message:this.$t("organizers/marketManage_30",{zh:"使用课程不能为空"})},{text:this.$t("organizers/marketManage_31",{zh:"领取有效期"}),required:!0,type:"PICKER",value:[],name:"draw",message:this.$t("organizers/marketManage_32",{zh:"领取有效期不能为空"})}]},columns:function(){return[{title:this.$t("organizers/marketManage_18",{zh:"优惠券名称"}),dataIndex:"remark",key:"remark",align:"center"},{title:this.$t("organizers/marketManage_17",{zh:"优惠券金额"}),dataIndex:"money",key:"money",align:"center"},{title:"优惠券限制",dataIndex:"restriction",key:"restriction",align:"center",scopedSlots:{customRender:"restriction"}},{title:this.$t("organizers/marketManage_19",{zh:"有效期"}),dataIndex:"valid",key:"valid",scopedSlots:{customRender:"valid"},align:"center",width:"20%"},{title:this.$t("organizers/marketManage_20",{zh:"总量"}),dataIndex:"total",key:"total",align:"center"},{title:this.$t("organizers/marketManage_21",{zh:"领取数量"}),dataIndex:"drawNumber",key:"drawNumber",align:"center"},{title:this.$t("organizers/marketManage_22",{zh:"使用数量"}),dataIndex:"useNumber",key:"useNumber",align:"center"},{title:this.$t("organizers/marketManage_47",{zh:"使用课程"}),dataIndex:"ownName",key:"ownName",align:"center",width:"10%"},{title:this.$t("organizers/marketManage_23",{zh:"领取链接"}),dataIndex:"link",key:"link",scopedSlots:{customRender:"link"},align:"center",width:"15%"},{title:this.$t("organizers/marketManage_24",{zh:"领取二维码"}),dataIndex:"qrcode",key:"qrcode",scopedSlots:{customRender:"qrcode"},align:"center"},{title:this.$t("organizers/traineesManage_16",{zh:"操作"}),dataIndex:"handle",key:"handle",scopedSlots:{customRender:"handle"},width:200,align:"center"}]}},mounted:function(){this.init()},methods:{searchData:function(){this.pagination.current=1,this.pagination.pageSize=10,this.getListHand()},filterOption:function(input,option){return option.componentOptions.propsData.label.indexOf(input)>-1},init:function(){this.getListHand(),this.getCourseSimple()},handleFee:function(t){this.feeVal=t.target.value.replace(/^(0+)|[^\d]+/g,"")},addCoupons:function(){this.title=1,this.couponStatus=!0},getListHand:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={page:t.pagination.current,pageSize:t.pagination.pageSize,remark:t.remark},e.next=3,Object(h.f)(n);case 3:r=e.sent,0===(data=r.data).code&&t.setTotalHandle(data,"entries",(function(){t.data=data.data.entries}));case 6:case"end":return e.stop()}}),e)})))()},getCourseSimple:function(){var t=this;Object(h.w)({type:2}).then((function(e){0===e.data.code&&(t.couponData[3].option=e.data.data)}))},emit:function(t){var e=this;this.title=2,this.couponStatus=!0,this.id=t.id,t.feeCond>0&&(this.feeVal=t.feeCond,this.feecond=1),t.expires>0?this.effective="1":this.effective="0",this.$nextTick((function(){e.form.setFieldsValue({money:t.money,remark:t.remark,total:t.total,expires:t.expires,courseId:t.ownId,valid:0===t.expires?[e.$moment(1e3*t.start),e.$moment(1e3*t.end)]:"",draw:[e.$moment(1e3*t.drawStart),e.$moment(1e3*t.drawEnd)]})}))},handleCancel:function(){this.form.resetFields(),this.feeVal=0,this.feecond=2,this.couponStatus=!1},deleteCoupon:function(t){var e=this,n=t.ownId,r=t.id;this.$confirm({title:"".concat(this.$t("organizers/marketManage_35",{zh:"您确定要删除该条优惠券吗"})),onOk:function(){Object(h.e)({courseId:n,couponId:r}).then((function(t){var n=t.data,data=n.data;0===n.code&&(1===data?(e.$message.success(e.$t("organizers/marketManage_36",{zh:"删除成功"})),e.handleCancel(),e.getListHand()):0===data?e.$message.error(e.$t("organizers/marketManage_37",{zh:"请求失败"})):-1===data?e.$message.error(e.$t("organizers/marketManage_38",{zh:"参数缺失"})):-2===data&&e.$message.error(e.$t("organizers/marketManage_39",{zh:"已领优惠劵不能删除"})))}))}})},dateToMs:function(t){return new Date(t).getTime()/1e3},handleSubmit:function(t){var e=this;t.preventDefault(),this.form.validateFields((function(t,n){if(!t){var r=n.draw,c=n.valid,l=Object(o.a)(n,["draw","valid"]),d=e.restriction,m=e.dateToMs(r[1]),f=e.dateToMs(r[0]),h=c&&e.dateToMs(c[1]),v=c&&e.dateToMs(c[0]);if(1===e.feecond&&!e.feeVal)return e.$message.error(e.$t("organizers/marketManage_40",{zh:"购买课程金额不能为空"}));if(n.expires)if(n.expires.toString().includes("."))return e.$message.error("失效小时不能输入小数点");1===e.title?e.couponSaveOrUpdata(y(y({},l),{},{restriction:d,start:v,end:h,drawStart:f,drawEnd:m,feeCond:e.feeVal})):e.couponSaveOrUpdata(y(y({},l),{},{restriction:d,start:v,end:h,drawStart:f,drawEnd:m,feeCond:e.feeVal,id:e.id}),e.$t("organizers/marketManage_41",{zh:"更新成功"}))}}))},couponSaveOrUpdata:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.$t("organizers/marketManage_42",{zh:"新增成功"});Object(h.h)(y({},t)).then((function(t){var r=t.data,code=r.code,data=r.data;0===code&&(1===data?(e.$message.success(n),e.handleCancel(),e.getListHand()):0===data?e.$message.error(e.$t("organizers/marketManage_37",{zh:"请求失败"})):-1===data&&e.$message.error(e.$t("organizers/marketManage_43",{zh:"优惠券数量修改不能少于已领取的数量"})))}))},handleFeeChange:function(t){this.feecond=t.target.value},validDate:function(data){return this.$changeTime(data,"YYYY-MM-DD HH:mm:ss")},createLink:function(t){return d.a.LINK.ais_pc+"/personal/mycoupon/"+t},createQrLink:function(t){return d.a.LINK.ais_h5+"/personal/mycoupon/"+t},copy:function(){this.$message.success(this.$t("organizers/marketManage_44",{zh:"复制成功"}))},downloadQr:function(){var t=this.$refs.qrcode.$refs["qrcode-vue"].toDataURL("image/png"),a=document.createElement("a");a.href=t,a.download=this.$t("organizers/marketManage_45",{zh:"优惠券二维码"}),a.click()},preview:function(){window.open(this.createLink(this.identify))},toCouponManage:function(t){var e=t.id;return"/organizers/couponManagement/".concat(e)},qrModalDownload:function(t){2===t&&this.downloadQr(),this.distributeStatus=!1}}},z=(n(2076),n(18)),k=Object(z.a)(C,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"market"},[r("div",{staticClass:"title"},[r("span",{staticClass:"strip"}),t._v(" "),r("p",{staticClass:"text"},[t._v("\n      "+t._s(t.$t("organizers/marketManage_1",{zh:"优惠券管理"}))+"\n    ")])]),t._v(" "),r("div",{staticClass:"addCoupons"},[r("a-button",{staticClass:"btn",attrs:{type:"primary",shape:"round"},on:{click:t.addCoupons}},[t._v("\n      "+t._s(t.$t("organizers/marketManage_2",{zh:"新增优惠券"}))+"\n    ")]),t._v(" "),r("div",{staticClass:"flex"},[r("div",{staticClass:"flex"},[r("a-input",{staticClass:"ml15 textLeft",staticStyle:{width:"240px"},attrs:{allowClear:"",placeholder:"请输入优惠券名称"},model:{value:t.remark,callback:function(e){t.remark=e},expression:"remark"}})],1),t._v(" "),r("div",{staticClass:"ml30 searchBtn",on:{click:t.searchData}},[t._v("\n        "+t._s(t.$t("financialManagement/CourseRevenue_10",{zh:"查询"}))+"\n      ")])])],1),t._v(" "),r("div",{staticClass:"couponsList"},[r("a-table",{attrs:{columns:t.columns,"data-source":t.data,rowKey:function(t){return t.id},pagination:t.pagination,loading:t.loading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"valid",fn:function(text,e){return r("span",{},[t._v("\n        "+t._s(0!==e.expires?t.$t("organizers/marketManage_50",{zh:"领取后"}):"")+" "+t._s(0===e.start?e.expires:t.validDate(e.start))+" "+t._s(0===e.start?t.$t("organizers/marketManage_53",{zh:"小时后"}):"-")+" "+t._s(0===e.start?"":t.validDate(e.end))+"\n      ")])}},{key:"restriction",fn:function(text,e){return r("span",{},[t._v("\n        "+t._s(0===e.restriction?"公开":"不公开")+"\n      ")])}},{key:"link",fn:function(text,e){return r("span",{},[t._v("\n        "+t._s(1===e.restriction?"":t.createLink(e.identify))+"\n      ")])}},{key:"qrcode",fn:function(text,e){return 1!==e.restriction?r("span",{staticStyle:{cursor:"pointer"}},[r("img",{attrs:{src:n(1478),alt:t.$t("organizers/marketManage_3",{zh:"二维码"})},on:{click:function(n){t.distributeStatus=!0,t.type=2,t.identify=e.identify}}})]):t._e()}},{key:"handle",fn:function(text,e){return r("div",{staticClass:"handle"},[1!==e.restriction?r("p",{on:{click:function(n){t.distributeStatus=!0,t.identify=e.identify,t.type=1}}},[t._v("\n          "+t._s(t.$t("organizers/marketManage_4",{zh:"分发"}))+"\n        ")]):t._e(),t._v(" "),r("p",{on:{click:function(n){return t.emit(e)}}},[t._v("\n          "+t._s(t.$t("organizers/marketManage_5",{zh:"编辑"}))+"\n        ")]),t._v(" "),r("p",[r("nuxt-link",{attrs:{to:t.toCouponManage(e)}},[t._v("\n            "+t._s(t.$t("organizers/marketManage_6",{zh:"管理"}))+"\n          ")])],1),t._v(" "),r("p",{on:{click:function(n){return t.deleteCoupon(e)}}},[t._v("\n          "+t._s(t.$t("organizers/marketManage_7",{zh:"删除"}))+"\n        ")])])}}],null,!0)})],1),t._v(" "),r("div",{ref:"couponPop",staticClass:"couponPop"},[r("a-modal",{staticClass:"pop",attrs:{width:"650px",title:1===t.title?t.$t("organizers/marketManage_2",{zh:"新增优惠券"}):t.$t("organizers/marketManage_8",{zh:"编辑优惠券"}),visible:t.couponStatus,getContainer:function(){return t.$refs.couponPop},okText:1===t.title?t.$t("organizers/traineesManage_17",{zh:"确定"}):t.$t("organizers/marketManage_9",{zh:"更新"})},on:{ok:t.handleSubmit,cancel:t.handleCancel}},[r("a-form",{attrs:{form:t.form,"wrapper-col":{span:24}}},[t._l(t.couponData,(function(e){return[r("a-form-item",{key:e.text},["INPUT"===e.type?r("div",{staticClass:"item"},[r("div",{class:[e.required?"hint":"noneReq"]},[t._v("\n                "+t._s(e.text)+"\n              ")]),t._v(" "),r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:[e.name,{rules:[{required:e.required,message:e.message}]}],expression:"[ele.name, { rules: [{ required: ele.required, message:ele.message }] }]"}],staticClass:"flexAuto",attrs:{type:e.formType,disabled:"money"===e.name&&1!==t.title}})],1):"SELECT"===e.type?r("div",{staticClass:"item"},[r("div",{class:[e.required?"hint":"noneReq"]},[t._v("\n                "+t._s(e.text)+"\n              ")]),t._v(" "),r("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:[e.name,{rules:[{required:e.required,message:e.message}]}],expression:"[ele.name, { rules: [{ required: ele.required, message:ele.message }] }]"}],attrs:{disabled:1!==t.title,"show-search":"","filter-option":t.filterOption}},t._l(e.option,(function(e){return r("a-select-option",{key:e.id,attrs:{value:e.id,label:e.name}},[r("span",[t._v(t._s(e.name))]),e.period&&e.period>0?r("span",[t._v("( 第"+t._s(e.period)+"期 )")]):t._e()])})),1)],1):r("div",{key:e.text,staticClass:"item"},[r("div",{class:[e.required?"hint":""]},[t._v("\n                "+t._s(e.text)+"\n              ")]),t._v(" "),r("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:[e.name,{rules:[{required:e.required,message:e.message}]}],expression:"[ele.name, { rules: [{ required: ele.required, message:ele.message}] }]"}],attrs:{format:"YYYY-MM-DD HH:mm:ss","show-time":{defaultValue:[t.moment("00:00:00","HH:mm:ss"),t.moment("23:59:59","HH:mm:ss")]}}})],1)])]})),t._v(" "),r("div",{staticClass:"flex-time"},[r("div",{staticClass:"hint mr20"},[t._v("\n            "+t._s(this.$t("organizers/marketManage_33",{zh:"优惠券有效期"}))+"\n          ")]),t._v(" "),r("div",{staticClass:"radio"},[r("a-radio-group",{model:{value:t.effective,callback:function(e){t.effective=e},expression:"effective"}},[r("a-radio",{staticClass:"radioStyle",attrs:{value:"0"}},[r("span",[t._v(t._s(t.$t("organizers/marketManage_49",{zh:"固定时间"})))])]),t._v(" "),r("a-radio",{staticClass:"radioStyle",attrs:{value:"1"}},[r("span",[t._v(t._s(t.$t("organizers/marketManage_50",{zh:"领取后"})))])])],1)],1)]),t._v(" "),"1"===t.effective?r("a-form-item",{staticClass:"input-row"},[r("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["expires",{rules:[{required:!0,message:t.$t("organizers/marketManage_57",{zh:"请输入失效时间"})}]}],expression:"['expires', { rules: [{ required: true, message: $t('organizers/marketManage_57', {zh:'请输入失效时间'}) }] }]"}],staticClass:"input",attrs:{"addon-after":"小时"}})],1):t._e(),t._v(" "),"0"===t.effective?r("a-form-item",{staticClass:"ml150"},[r("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["valid",{rules:[{required:!0,message:t.$t("organizers/marketManage_34",{zh:"优惠券有效期不能为空"})}]}],expression:"[ 'valid', { rules: [{ required: true, message: $t('organizers/marketManage_34', {zh:'优惠券有效期不能为空'}) }] }]"}],attrs:{format:"YYYY-MM-DD HH:mm:ss","show-time":{defaultValue:[t.moment("00:00:00","HH:mm:ss"),t.moment("23:59:59","HH:mm:ss")]}}})],1):t._e(),t._v(" "),r("div",{staticClass:"discount"},[r("div",{staticClass:"hint"},[t._v("\n            "+t._s(t.$t("organizers/marketManage_10",{zh:"优惠条件"}))+"\n          ")]),t._v(" "),r("div",{staticClass:"radio"},[r("a-radio-group",{staticClass:"group",attrs:{value:t.feecond,disabled:1!==t.title},on:{change:t.handleFeeChange}},[r("a-radio",{staticClass:"radioStyle",attrs:{value:1}},[r("span",[t._v(t._s(t.$t("organizers/marketManage_11",{zh:"购买课程金额满"})))]),t._v(" "),r("a-input",{staticStyle:{width:"100px",margin:"0px 10px"},attrs:{value:t.feeVal,disabled:1!==t.feecond||1!==t.title,type:"number"},on:{change:t.handleFee}}),t._v(" "),r("span",[t._v(t._s(t.$t("organizers/traineesManage_4",{zh:"元"})))])],1),t._v(" "),r("a-radio",{staticClass:"radioStyle",attrs:{value:2}},[r("span",[t._v(t._s(t.$t("organizers/marketManage_12",{zh:"无优惠条件"})))])])],1)],1)]),t._v(" "),r("div",{staticClass:"flex-time borderTop"},[r("div",{staticClass:"hint mr20"},[t._v("\n            优惠券限制\n          ")]),t._v(" "),r("div",{staticClass:"radio"},[r("a-radio-group",{model:{value:t.restriction,callback:function(e){t.restriction=e},expression:"restriction"}},[r("a-radio",{staticClass:"radioStyle",attrs:{value:"0"}},[r("span",[t._v("公开")])]),t._v(" "),r("a-radio",{staticClass:"radioStyle",attrs:{value:"1"}},[r("span",[t._v("不公开(不可转发不可复制)")])])],1)],1)])],2)],1)],1),t._v(" "),r("div",[r("a-modal",{attrs:{visible:t.distributeStatus,title:1===t.type?t.$t("organizers/marketManage_4",{zh:"分发"}):t.$t("organizers/marketManage_3",{zh:"二维码"}),footer:null},on:{cancel:function(e){t.distributeStatus=!1}}},[r("div",{directives:[{name:"show",rawName:"v-show",value:1===t.type,expression:"type === 1"}]},[r("p",{staticClass:"distributeTitle"},[t._v("\n          "+t._s(t.$t("organizers/marketManage_13",{zh:"领取链接"}))+"\n        ")]),t._v(" "),r("div",{staticClass:"distributeContent"},[r("div",{staticClass:"top"},[r("a-input",{staticClass:"height36",attrs:{value:t.createLink(t.identify),disabled:""}}),t._v(" "),r("a-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.createLink(t.identify),expression:"createLink(identify)",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.copy,expression:"copy",arg:"success"}],staticClass:"copy height36"},[t._v("\n              "+t._s(t.$t("organizers/marketManage_14",{zh:"复制链接"}))+"\n            ")])],1),t._v(" "),r("div",{staticClass:"bottom"},[r("div",{staticClass:"img"},[r("qrcode-vue",{ref:"qrcode",attrs:{value:t.createQrLink(t.identify),size:"134"}})],1),t._v(" "),r("div",{staticClass:"btn"},[r("a-button",{staticClass:"height36",staticStyle:{"margin-right":"36px",background:"rgba(74,144,226,1)",color:"#ffffff"},on:{click:t.downloadQr}},[t._v("\n                "+t._s(t.$t("organizers/marketManage_15",{zh:"下载二维码"}))+"\n              ")]),t._v(" "),r("a-button",{staticClass:"height36",staticStyle:{background:"rgba(54,183,207,1)",color:"#ffffff"},on:{click:t.preview}},[t._v("\n                "+t._s(t.$t("organizers/marketManage_16",{zh:"预览页面"}))+"\n              ")])],1)])])]),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:2===t.type,expression:"type === 2"}],staticStyle:{"text-align":"center"}},[r("qrcode-vue",{attrs:{value:t.createQrLink(t.identify),size:"250"}})],1),t._v(" "),r("div",{staticStyle:{"text-align":"center","margin-top":"30px"}},[r("a-button",{staticStyle:{width:"120px",height:"45px"},on:{click:function(e){t.distributeStatus=!1}}},[t._v("\n          "+t._s(t.$t("courseManagement/AddChaperCurriculum_FormCommonHand/AddChaperCurriculum_20",{zh:"取消"}))+"\n        ")]),t._v(" "),r("a-button",{style:{background:1===t.type?"#fa6400":"rgb(74, 144, 226)",borderColor:1===t.type?"#fa6400":"rgb(74, 144, 226)",color:"#ffffff",width:"120px",height:"45px",marginLeft:"10px"},on:{click:function(e){return t.qrModalDownload(t.type)}}},[t._v("\n          "+t._s(1===t.type?t.$t("organizers/traineesManage_17",{zh:"确定"}):t.$t("organizers/marketManage_46",{zh:"下载"}))+"\n        ")])],1)])],1)])}),[],!1,null,"795db8f8",null).exports,$=(n(89),n(1048),n(90)),x=n(76),w=n(42);function O(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function I(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?O(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):O(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var S={mixins:[v.a],data:function(){return{config:d.a,visible:!1,data:[],courseId:0,orderBy:"",labelCol:{span:4},wrapperCol:{span:20},formInline:{name:"",type:"0"},formSet:{open:!1,carry_fee:"",poster:""},rules:{carry_fee:[{required:!0,message:"请输入佣金比例"},{validator:this.validator}]}}},computed:{columns:function(){var t=this;return[{title:this.$t("courseManagement/ChapterCourseList_FormCommonHand/ChapterCourseList_27",{zh:"课程名称"}),dataIndex:"name",key:"name",customRender:function(t,e){return e.period>0?t+"( 第".concat(e.period,"期 )"):t}},{title:this.$t("courseManagement/ChapterCourseList_FormCommonHand/ChapterCourseList_28",{zh:"类型"}),dataIndex:"scene",key:"scene ",customRender:function(text){return Object($.d)(t)[text]||"-"}},{title:this.$t("courseManagement/AddChaperCurriculum_FormCommonHand/AddChaperCurriculum_4",{zh:"课程类型"}),dataIndex:"type",key:"type",customRender:function(text){return Object($.f)(t)[text]}},{title:this.$t("organizers/promotion_15",{zh:"课程价格"})+"( ".concat(this.$t("courseManagement/ChapterCourseList_FormCommonHand/ChapterCourseList_4",{zh:"元"})," )"),dataIndex:"price",key:"price"},{title:this.$t("courseManagement/ChapterCourseList_FormCommonHand/ChapterCourseList_30",{zh:"开播时间"}),dataIndex:"start",key:"start",customRender:function(text){return text&&Object(w._moment)(1e3*text).format("YYYY/MM/DD HH:mm:ss")||0}},{title:this.$t("courseManagement/ChapterCourseList_FormCommonHand/ChapterCourseList_39",{zh:"上架状态"}),dataIndex:"status",key:"status",customRender:function(text){return Object($.e)(t)[text]}},{title:this.$t("organizers/promotion_16",{zh:"推广次数"}),dataIndex:"inviteesNumber",key:"inviteesNumber",sorter:!0},{title:this.$t("organizers/promotion_5",{zh:"总佣金"})+"( ".concat(this.$t("courseManagement/ChapterCourseList_FormCommonHand/ChapterCourseList_4",{zh:"元"})," )"),dataIndex:"all_carry_fee",key:"all_carry_fee",sorter:!0},{title:this.$t("courseManagement/ChapterList_FormCommonHand/ChapterList_14",{zh:"操作"}),dataIndex:"handle",key:"handle",scopedSlots:{customRender:"handle"}}]},open:function(){return this.$t("organizers/promotion_19",{zh:"分销开关"})},fee:function(){return this.$t("organizers/promotion_27",{zh:"佣金比例"})},poster:function(){return this.$t("organizers/promotion_22",{zh:"上传海报"})},courseName:function(){return this.$t("courseManagement/ChapterCourseList_FormCommonHand/ChapterCourseList_27",{zh:"课程名称"})},promotion:function(){return this.$t("organizers/promotion_25",{zh:"推广"})}},created:function(){this.getListHand()},methods:{handleSubmit:function(){this.getListHand()},handleFee:function(t){var e=t.target.value;this.formSet.carry_fee=e.replace(/^(0+)|[^\d]+/g,"")},validator:function(t,e,n){(Number(e)<0||Number(e)>80)&&n(new Error("佣金比例必须在0-80之间")),n()},handleOk:function(){var t=this;this.$refs.promotion.validate(function(){var e=Object(c.a)(regeneratorRuntime.mark((function e(n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=8;break}return(r=I({courseId:t.courseId},t.formSet)).open=r.open?1:0,e.next=5,Object(h.y)(r);case 5:o=e.sent,0===o.data.code&&(t.visible=!1,t.getListHand(),t.$message.success("保存成功"));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},customPosterRequest:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var r,o,c,code,l;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return(r=new FormData).append("file",t.file),n.next=4,Object(x.d)(r);case 4:o=n.sent,c=o.data,code=c.code,l=c.data,0===code&&(e.formSet.poster=l);case 9:case"end":return n.stop()}}),n)})))()},remove:function(){this.formSet.poster=""},getListHand:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={name:t.formInline.name,orderField:t.orderBy,page:t.pagination.current,pageSize:t.pagination.pageSize},0===Number(t.formInline.type)?delete n.type:n.type=Number(t.formInline.type),e.next=4,Object(h.x)(n);case 4:r=e.sent,0===(data=r.data).code&&t.setTotalHandle(data,"entries",(function(){t.data=data.data.entries}));case 7:case"end":return e.stop()}}),e)})))()},handleSet:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var r,o,data,c,l,d,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.id,e.visible=!0,e.courseId=r,n.next=5,Object(h.z)(r);case 5:o=n.sent,0===(data=o.data).code&&(c=data.data||{},l=c.open,d=c.poster,m=c.carry_fee,e.formSet.open=!!l,e.formSet.poster=d,e.formSet.carry_fee=m);case 8:case"end":return n.stop()}}),n)})))()},handleChange:function(t,e,n){var r=t.current,o=t.pageSize,c=n.columnKey,l=n.order,d={inviteesNumber:1,all_carry_fee:2},m={ascend:-Number(d[c]),descend:Number(d[c])};this.orderBy=m[l]||"",this.handlePaginatChange(r,o)}}},M=(n(2077),Object(z.a)(S,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"promotion"},[r("div",{staticClass:"seach"},[r("a-form-model",{attrs:{layout:"inline",model:t.formInline}},[r("a-form-model-item",{attrs:{label:t.courseName}},[r("a-input",{attrs:{placeholder:"请输入关键字"},model:{value:t.formInline.name,callback:function(e){t.$set(t.formInline,"name",e)},expression:"formInline.name"}})],1),t._v(" "),r("a-form-model-item",{attrs:{label:t.promotion}},[r("a-select",{staticStyle:{width:"200px"},model:{value:t.formInline.type,callback:function(e){t.$set(t.formInline,"type",e)},expression:"formInline.type"}},[r("a-select-option",{attrs:{value:"0"}},[t._v("\n            "+t._s(t.$t("courseManagement/CourseList_FormCommonHand/CourseList_3",{zh:"全部"}))+"\n          ")]),t._v(" "),r("a-select-option",{attrs:{value:"2"}},[t._v("\n            "+t._s(t.$t("organizers/promotion_24",{zh:"已推广"}))+"\n          ")]),t._v(" "),r("a-select-option",{attrs:{value:"1"}},[t._v("\n            "+t._s(t.$t("organizers/promotion_23",{zh:"未推广"}))+"\n          ")])],1)],1),t._v(" "),r("a-form-model-item",[r("a-button",{staticClass:"query",attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("\n          "+t._s(t.$t("financialManagement/CourseRevenue_10",{zh:"查询"}))+"\n        ")])],1)],1)],1),t._v(" "),r("div",{staticClass:"table"},[r("a-table",{attrs:{rowKey:function(t){return t.id},columns:t.columns,"data-source":t.data,pagination:t.pagination},on:{change:t.handleChange},scopedSlots:t._u([{key:"handle",fn:function(text,e){return r("div",{staticClass:"detail",on:{click:function(n){return t.handleSet(e)}}},[t._v("\n        "+t._s(t.$t("organizers/promotion_20",{zh:"推广设置"}))+"\n      ")])}}])})],1),t._v(" "),r("div",{staticClass:"pop"},[r("a-modal",{attrs:{visible:t.visible,footer:!1},on:{cancel:function(e){t.visible=!1}}},[r("div",{staticClass:"popTitle",attrs:{slot:"title"},slot:"title"},[r("span",[t._v(t._s(t.$t("organizers/promotion_20",{zh:"推广设置"})))]),t._v(" "),r("a-tooltip",{attrs:{placement:"bottom"}},[r("template",{slot:"title"},[t._v("\n            "+t._s(t.$t("organizers/promotion_21",{zh:"推广设置为可让艾思用户进行分享推广，推广成功（购买课程）后发放佣金"}))+"\n          ")]),t._v(" "),r("img",{attrs:{src:n(1480),alt:"问号"}})],2)],1),t._v(" "),r("div",[r("a-form-model",{ref:"promotion",attrs:{rules:t.rules,model:t.formSet,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[r("a-form-model-item",{attrs:{label:t.open,prop:"open"}},[r("a-switch",{model:{value:t.formSet.open,callback:function(e){t.$set(t.formSet,"open",e)},expression:"formSet.open"}})],1),t._v(" "),r("a-form-model-item",{attrs:{label:t.fee,prop:"carry_fee"}},[r("a-input",{attrs:{placeholder:"课程价格与佣金比例",type:"number",suffix:"%"},on:{change:t.handleFee},model:{value:t.formSet.carry_fee,callback:function(e){t.$set(t.formSet,"carry_fee",e)},expression:"formSet.carry_fee"}})],1),t._v(" "),r("a-form-model-item",{attrs:{label:t.poster}},[r("a-upload",{attrs:{name:"avatar","list-type":"picture-card","show-upload-list":!1,customRequest:t.customPosterRequest}},[r("div",{staticClass:"uploadBox"},[t.formSet.poster?r("div",{staticClass:"icon",on:{click:function(e){return e.stopPropagation(),t.remove(e)}}},[r("a-icon",{attrs:{type:"close"}})],1):t._e(),t._v(" "),t.formSet.poster?r("div",[r("img",{attrs:{src:t.config.IMG_URL.default+t.formSet.poster,alt:"海报",width:"100%"}})]):r("div",{staticClass:"avatar-uploader"},[r("img",{attrs:{src:n(1481),alt:"avatar"}}),t._v(" "),r("p",[t._v(t._s(t.$t("organizers/promotion_18",{zh:"上传卡片"})))])])])])],1)],1),t._v(" "),r("a-row",{attrs:{type:"flex",justify:"end"}},[r("a-col",{attrs:{span:20}},[r("div",{staticClass:"submit"},[r("a-button",{staticClass:"btn",on:{click:function(e){t.visible=!1}}},[t._v("\n                "+t._s(t.$t("courseManagement/AddChaperCurriculum_FormCommonHand/AddChaperCurriculum_20",{zh:"取消"}))+"\n              ")]),t._v(" "),r("a-button",{staticClass:"btn",on:{click:t.handleOk}},[t._v("\n                "+t._s(t.$t("organizers/promotion_17",{zh:"确认"}))+"\n              ")])],1)])],1)],1)])],1)])}),[],!1,null,"31a71f64",null).exports),j={mixins:[v.a],data:function(){return{data:[],loading:!1,courseId:null,visible:!1}},computed:{columns:function(){return[{title:"ID",dataIndex:"id",key:"id",align:"center"},{title:this.$t("pages/CallActivity_29",{zh:"账号"}),dataIndex:"account",key:"account",align:"center"},{title:this.$t("pages/CallActivity_30",{zh:"昵称"}),dataIndex:"nickname",key:"nickname",align:"center"},{title:this.$t("pages/CallActivity_31",{zh:"助力人数"}),dataIndex:"invite",key:"invite",align:"center"},{title:this.$t("pages/CallActivity_32",{zh:"状态"}),dataIndex:"status",key:"status",scopedSlots:{customRender:"status"},align:"center"},{title:this.$t("pages/CallActivity_33",{zh:"解锁时间"}),dataIndex:"updateTime",key:"updateTime",scopedSlots:{customRender:"updateTime"},align:"center"}]}},methods:{handleOpen:function(t){this.courseId=t,this.pagination.current=1,this.getListHand(),this.visible=!0},handleCancel:function(){this.visible=!1},getListHand:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={page:t.pagination.current,pageSize:t.pagination.pageSize,activityId:t.courseId},e.next=3,Object(h.o)(n);case 3:r=e.sent,0===(data=r.data).code&&t.setTotalHandle(data,"entries",(function(){t.data=data.data.entries}));case 6:case"end":return e.stop()}}),e)})))()}}};function H(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function L(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?H(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):H(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var D={components:{CallActivityDetail:Object(z.a)(j,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-modal",{staticClass:"modal",attrs:{title:t.$t("pages/CallActivity_26",{zh:"活动详情"}),visible:t.visible,footer:null,width:971},on:{cancel:t.handleCancel}},[n("a-table",{attrs:{columns:t.columns,"data-source":t.data,rowKey:function(t){return t.id},pagination:t.pagination,loading:t.loading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"updateTime",fn:function(text,e){return n("div",{},[t._v("\n      "+t._s(e.updateTime&&1===e.status?t.$changeTime(e.updateTime):"--")+"\n    ")])}},{key:"status",fn:function(text,e){return n("div",{},[t._v("\n      "+t._s(1===e.status?t.$t("pages/CallActivity_27",{zh:"已解锁"}):4===e.status?"解锁失败":t.$t("pages/CallActivity_28",{zh:"未解锁"}))+"\n    ")])}}])})],1)}),[],!1,null,null,null).exports},mixins:[v.a],data:function(){return{visible:!1,data:[],form:{time:[]},labelCol:{span:5},wrapperCol:{span:19},courseData:[],loading:!1,serachForm:{courseId:"",id:""},moment:f.a}},computed:{rules:function(){return{courseId:{required:!0,message:this.$t("pages/CallActivity_3",{zh:"请选择课程"}),trigger:"blur"},ts:{required:!0,message:this.$t("pages/CallActivity_15",{zh:"请选择活动时间"}),trigger:"blur"},numCond:{required:!0,message:this.$t("pages/CallActivity_16",{zh:"请输入集call人数"}),trigger:"blur"},share:{required:!0,message:this.$t("pages/CallActivity_35",{zh:"请输入邀请语"}),trigger:"blur"},time:{required:!0,message:"请选择活动时间"}}},columns:function(){return[{title:"ID",dataIndex:"id",key:"id",align:"center"},{title:this.$t("pages/CallActivity_17",{zh:"课程名称"}),dataIndex:"courseName",key:"courseName",align:"center",scopedSlots:{customRender:"courseName"}},{title:this.$t("pages/CallActivity_18",{zh:"集call人数"}),dataIndex:"numCond",key:"numCond",align:"center"},{title:this.$t("pages/CallActivity_19",{zh:"助力总人数"}),dataIndex:"invite",key:"invite",align:"center"},{title:this.$t("pages/CallActivity_20",{zh:"发起次数"}),dataIndex:"num",key:"num",align:"center"},{title:this.$t("pages/CallActivity_21",{zh:"完成人数"}),dataIndex:"complete",key:"complete",align:"center"},{title:this.$t("pages/CallActivity_22",{zh:"注册用户数"}),dataIndex:"register",key:"register",align:"center"},{title:this.$t("pages/CallActivity_23",{zh:"集call时间"}),dataIndex:"ts",key:"ts",align:"center",scopedSlots:{customRender:"ts"}},{title:this.$t("pages/CallActivity_24",{zh:"创建时间"}),dataIndex:"createTime",key:"createTime",scopedSlots:{customRender:"createTime"},align:"center"},{title:this.$t("pages/CallActivity_25",{zh:"状态"}),dataIndex:"status",key:"status",scopedSlots:{customRender:"status"},align:"center"},{title:"活动时间",dataIndex:"time",key:"time",scopedSlots:{customRender:"time"},align:"center"},{title:this.$t("organizers/traineesManage_16",{zh:"操作"}),dataIndex:"handle",key:"handle",scopedSlots:{customRender:"handle"},width:150,align:"center"}]}},mounted:function(){this.getListHand()},methods:{getListHand:function(){var t=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,r,o,c,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.courseData.length){e.next=6;break}return e.next=3,Object(h.w)({type:2});case 3:n=e.sent,0===(r=n.data).code&&(t.courseData=r.data);case 6:return o={page:t.pagination.current,pageSize:t.pagination.pageSize},t.serachForm.id&&(o.courseId=t.serachForm.id),e.next=10,Object(h.p)(o);case 10:c=e.sent,0===(data=c.data).code&&t.setTotalHandle(data,"entries",(function(){t.data=data.data.entries}));case 13:case"end":return e.stop()}}),e)})))()},onChange:function(t){var e=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(h.E)({id:t.id,onStore:0===t.status});case 2:r=n.sent,0===r.data.code&&e.getListHand();case 5:case"end":return n.stop()}}),n)})))()},filterOption:function(input,option){return option.componentOptions.children[0].text&&option.componentOptions.children[0].text.indexOf(input)>=0},showDetail:function(t){this.$refs.CallActivityDetail.handleOpen(t.id)},edit:function(t){var e=t.id,n=t.ts,r=t.numCond,o=t.courseId,c=t.share,l=t.newcomer;this.form={id:e,ts:n,numCond:r,courseId:o,share:c,time:t.start>0&&t.end>0?[this.$moment(1e3*t.start),this.$moment(1e3*t.end)]:[],newcomer:1===l},this.visible=!0},addCall:function(){this.visible=!0},searchData:function(){this.pagination.current=1,this.serachForm.id=this.serachForm.courseId,this.getListHand()},dateToMs:function(t){return new Date(t).getTime()/1e3},handleOk:function(){var t=this;this.$refs.ruleForm.validate(function(){var e=Object(c.a)(regeneratorRuntime.mark((function e(n){var r,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=10;break}if(!(t.form.ts+"").includes(".")){e.next=3;break}return e.abrupt("return",t.$message.error("时间只能为整数!"));case 3:return r=t.dateToMs(t.form.time[1]),o=t.dateToMs(t.form.time[0]),e.next=7,Object(h.D)(L(L({},t.form),{},{start:o,end:r,newcomer:t.form.newcomer?1:0,time:null}));case 7:c=e.sent,0===c.data.code&&(t.pagination.current=1,t.getListHand(),t.handleCancel());case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},handleCancel:function(){this.visible=!1,this.form={}}}},T=(n(2078),Object(z.a)(D,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"pl30 pr30"},[n("div",{staticClass:"pt20 pb20 handleWrap"},[n("a-button",{staticClass:"btn",attrs:{type:"primary",shape:"round"},on:{click:t.addCall}},[t._v("\n      "+t._s(t.$t("pages/CallActivity_2",{zh:"新增集call"}))+"\n    ")]),t._v(" "),n("div",{staticClass:"flex"},[n("a-select",{staticStyle:{width:"240px"},attrs:{placeholder:t.$t("pages/CallActivity_3",{zh:"请选择课程"}),showSearch:!0,"option-filter-prop":"children","filter-option":t.filterOption},model:{value:t.serachForm.courseId,callback:function(e){t.$set(t.serachForm,"courseId",e)},expression:"serachForm.courseId"}},[n("a-select-option",{attrs:{value:-1}},[t._v("\n          "+t._s(t.$t("courseManagement/CourseList_FormCommonHand/CourseList_3",{zh:"全部"}))+"\n        ")]),t._v(" "),t._l(t.courseData,(function(e){return n("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v("\n          "+t._s(e.period&&e.period>0?e.name+"(第"+e.period+"期)":e.name)+"\n        ")])}))],2),t._v(" "),n("div",{staticClass:"ml30 searchBtn",on:{click:t.searchData}},[t._v("\n        "+t._s(t.$t("financialManagement/CourseRevenue_10",{zh:"查询"}))+"\n      ")])],1)],1),t._v(" "),n("div",[n("a-table",{attrs:{columns:t.columns,"data-source":t.data,rowKey:function(t){return t.id},pagination:t.pagination,loading:t.loading},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"courseName",fn:function(text,e){return n("div",{},[t._v("\n        "+t._s(e.period>0?e.courseName+"(第"+e.period+"期)":e.courseName)+"\n      ")])}},{key:"createTime",fn:function(text,e){return n("div",{},[t._v("\n        "+t._s(t.$changeTime(e.createTime))+"\n      ")])}},{key:"ts",fn:function(text,e){return n("div",{},[t._v("\n        "+t._s(e.ts+"h")+"\n      ")])}},{key:"status",fn:function(text,e){return n("div",{},[n("a-switch",{attrs:{checked:1===e.status},on:{change:function(n){return t.onChange(e)}}})],1)}},{key:"time",fn:function(text,e){return n("div",{},[t._v("\n        "+t._s(e.start>0&&e.end>0?t.$changeTime(e.start)+"-"+t.$changeTime(e.end):"--")+"\n      ")])}},{key:"handle",fn:function(text,e){return n("div",{staticClass:"handle"},[n("div",{staticClass:"hand",on:{click:function(n){return t.edit(e)}}},[t._v("\n          "+t._s(t.$t("organizers/marketManage_5",{zh:"编辑"}))+"\n        ")]),t._v(" "),n("div",{staticClass:"hand",on:{click:function(n){return t.showDetail(e)}}},[t._v("\n          "+t._s(t.$t("pages/CallActivity_4",{zh:"活动详情"}))+"\n        ")])])}}])})],1),t._v(" "),n("a-modal",{staticClass:"modal",attrs:{title:t.form.id?t.$t("pages/CallActivity_5",{zh:"编辑活动"}):t.$t("pages/CallActivity_6",{zh:"新增活动"}),visible:t.visible,footer:null,width:574},on:{ok:t.handleOk,cancel:t.handleCancel}},[t.visible?n("a-form-model",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[n("a-form-model-item",{attrs:{label:t.$t("pages/CallActivity_7",{zh:"选择课程"}),prop:"courseId"}},[n("a-select",{attrs:{placeholder:t.$t("pages/CallActivity_3",{zh:"请选择课程"}),showSearch:!0,"option-filter-prop":"children","filter-option":t.filterOption,disabled:!!t.form.id},model:{value:t.form.courseId,callback:function(e){t.$set(t.form,"courseId",e)},expression:"form.courseId"}},t._l(t.courseData,(function(e,r){return n("a-select-option",{key:r,attrs:{value:e.id}},[t._v("\n            "+t._s(e.period&&e.period>0?e.name+"(第"+e.period+"期)":e.name)+"\n          ")])})),1)],1),t._v(" "),n("a-form-model-item",{attrs:{label:"活动时间",prop:"time"}},[n("a-range-picker",{attrs:{format:"YYYY-MM-DD HH:mm:ss","show-time":{defaultValue:[t.moment("00:00:00","HH:mm:ss"),t.moment("23:59:59","HH:mm:ss")]}},model:{value:t.form.time,callback:function(e){t.$set(t.form,"time",e)},expression:"form.time"}})],1),t._v(" "),n("a-form-model-item",{staticClass:"ts",attrs:{label:t.$t("pages/CallActivity_8",{zh:"集call时间"}),prop:"ts"}},[n("a-input-number",{attrs:{min:1,placeholder:t.$t("pages/CallActivity_9",{zh:"请输入时间"})},model:{value:t.form.ts,callback:function(e){t.$set(t.form,"ts",e)},expression:"form.ts"}}),t._v(t._s(t.$t("pages/CallActivity_10",{zh:"小时"}))+"\n        "),n("span",{staticClass:"tips"},[t._v(t._s(t.$t("pages/CallActivity_11",{zh:"设定时间最小不能小于1小时"})))])],1),t._v(" "),n("a-form-model-item",{attrs:{label:t.$t("pages/CallActivity_12",{zh:"集call人数"}),prop:"numCond"}},[n("a-input-number",{attrs:{min:1,placeholder:t.$t("pages/CallActivity_13",{zh:"请输入人数"})},model:{value:t.form.numCond,callback:function(e){t.$set(t.form,"numCond",e)},expression:"form.numCond"}})],1),t._v(" "),n("a-form-model-item",{attrs:{label:t.$t("pages/CallActivity_34",{zh:"邀请语"}),prop:"share"}},[n("a-textarea",{attrs:{min:1,placeholder:t.$t("pages/CallActivity_35",{zh:"请输入邀请语"}),maxLength:80},model:{value:t.form.share,callback:function(e){t.$set(t.form,"share",e)},expression:"form.share"}})],1),t._v(" "),n("a-form-model-item",{attrs:{label:"仅限新人"}},[n("a-switch",{model:{value:t.form.newcomer,callback:function(e){t.$set(t.form,"newcomer",e)},expression:"form.newcomer"}})],1)],1):t._e(),t._v(" "),n("a-button",{staticClass:"formBtn",attrs:{type:"primary"},on:{click:t.handleOk}},[t._v("\n      "+t._s(t.$t("pages/CallActivity_14",{zh:"确定"}))+"\n    ")])],1),t._v(" "),n("CallActivityDetail",{ref:"CallActivityDetail"})],1)}),[],!1,null,"ce17a0f2",null).exports),A={layout:"organizers",components:{DiscountCoupon:k,Promotion:M,Tabs:n(1280).a,CallActivity:T},data:function(){return{}},computed:{list:function(){return[{title:this.$t("organizers/marketManage_1",{zh:"优惠券管理"}),key:"coupon"},{title:this.$t("organizers/promotion_14",{zh:"推广管理"}),key:"promotion"},{title:this.$t("pages/CallActivity_1",{zh:"集call活动"}),key:"CallActivity"}]}}},P=(n(2079),Object(z.a)(A,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"market"},[e("div",{staticClass:"tabs"},[e("Tabs",{attrs:{data:this.list}},[e("div",{staticClass:"bgWhite",attrs:{slot:"coupon"},slot:"coupon"},[e("DiscountCoupon")],1),this._v(" "),e("div",{staticClass:"bgWhite",attrs:{slot:"promotion"},slot:"promotion"},[e("Promotion")],1),this._v(" "),e("div",{staticClass:"bgWhite",attrs:{slot:"CallActivity"},slot:"CallActivity"},[e("CallActivity")],1)])],1)])}),[],!1,null,"79a7f8e9",null));e.default=P.exports}}]);